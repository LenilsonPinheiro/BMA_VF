{% extends "base.html" %}

{% block title %}Instabilidade Temporária (500) - Belarmino Monteiro{% endblock %}
{% block metadescription %}Ocorreu uma falha interna momentânea. Nossa equipe técnica já está atuando para restabelecer o serviço.{% endblock %}

{% block content %}

<style>
    /* --- VARIÁVEIS DE SEGURANÇA ADAPTATIVAS --- */
    :root {
        /* Variáveis com Fallback para Theme Engine */
        --err-bg-light: var(--prm-bg-light, #f8f9fa);
        --err-text: var(--prm-text, #333);
        --err-accent: var(--prm-accent-red, #b92027);
        --err-code-color: rgba(0,0,0,0.03);
        --glass-bg: rgba(255, 255, 255, 0.9);
        --glass-border: rgba(255, 255, 255, 1);
        --page-padding-top: clamp(120px, 20vh, 180px);
    }

    /* DARK MODE ENGINE */
    body.dark-mode, [data-theme="dark"] {
        --err-bg-light: var(--prm-bg-surface, #0f1215);
        --err-text: var(--prm-text, #e0e0e0);
        --err-code-color: rgba(255,255,255,0.03);
        --glass-bg: rgba(20, 25, 30, 0.85);
        --glass-border: rgba(255, 255, 255, 0.05);
    }

    /* --- AMBIENTE --- */
    .error-page-wrapper {
        min-height: 85vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding-top: var(--page-padding-top);
        padding-bottom: 80px;
        background-color: var(--err-bg-light);
        /* Padrão de fundo técnico (Grid) */
        background-image: 
            linear-gradient(rgba(150, 150, 150, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(150, 150, 150, 0.05) 1px, transparent 1px);
        background-size: 30px 30px;
        position: relative;
        overflow: hidden;
    }

    /* Efeito de "Radar" ou "Scan" no fundo */
    .error-page-wrapper::after {
        content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: radial-gradient(circle at 50% 50%, rgba(var(--err-accent), 0.08), transparent 60%);
        pointer-events: none;
        animation: pulseRadar 4s infinite alternate;
    }

    @keyframes pulseRadar {
        0% { opacity: 0.3; transform: scale(0.8); }
        100% { opacity: 0.8; transform: scale(1.2); }
    }

    /* --- CARD DE ERRO --- */
    .error-card {
        width: 100%; max-width: 600px;
        background: var(--glass-bg);
        backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 60px 40px;
        text-align: center;
        box-shadow: 0 25px 60px rgba(0,0,0,0.08);
        position: relative;
        z-index: 10;
        overflow: hidden;
    }

    /* Código 500 Gigante ao Fundo */
    .bg-code {
        position: absolute; top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        font-size: 12rem; font-weight: 900;
        color: var(--err-code-color);
        z-index: -1; user-select: none;
        font-family: var(--font-primary, sans-serif);
        line-height: 1;
    }

    /* --- CONTEÚDO --- */
    .icon-box {
        width: 90px; height: 90px; margin: 0 auto 30px;
        background: rgba(185, 32, 39, 0.1);
        border-radius: 50%; display: flex; align-items: center; justify-content: center;
        position: relative;
    }
    
    .icon-box i { font-size: 3rem; color: var(--err-accent); }
    
    /* Animação de Engrenagem ou Pulso */
    .icon-box::before {
        content: ''; position: absolute; inset: -5px; border-radius: 50%;
        border: 2px dashed var(--err-accent); opacity: 0.3;
        animation: spinSlow 10s linear infinite;
    }

    @keyframes spinSlow { to { transform: rotate(360deg); } }

    .error-title {
        font-family: var(--font-primary, serif);
        font-size: clamp(1.8rem, 4vw, 2.5rem);
        font-weight: 700; color: var(--err-text);
        margin-bottom: 15px;
    }

    .error-msg {
        font-size: 1.05rem; color: var(--err-text); opacity: 0.8;
        line-height: 1.6; margin-bottom: 40px;
        font-family: var(--font-secondary, sans-serif);
    }

    /* --- BOTÕES --- */
    .btn-action {
        display: inline-flex; align-items: center; gap: 10px;
        padding: 14px 30px; border-radius: 50px;
        font-weight: 600; text-transform: uppercase; font-size: 0.9rem;
        transition: 0.3s; text-decoration: none; cursor: pointer;
        font-family: var(--font-secondary, sans-serif);
    }

    .btn-primary-err {
        background: var(--err-accent); color: #fff; border: none;
        box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }
    .btn-primary-err:hover {
        filter: brightness(0.9); transform: translateY(-2px);
        box-shadow: 0 12px 25px rgba(0,0,0,0.2); color: #fff;
    }

    .btn-secondary-err {
        background: transparent; color: var(--err-text);
        border: 1px solid rgba(150, 150, 150, 0.3);
        margin-left: 10px;
    }
    .btn-secondary-err:hover {
        background: rgba(150, 150, 150, 0.1); border-color: var(--err-text);
    }
    
    /* Ajuste de Botões no Dark Mode */
    body.dark-mode .btn-secondary-err, [data-theme="dark"] .btn-secondary-err {
        border-color: rgba(255,255,255,0.2);
    }
    body.dark-mode .btn-secondary-err:hover, [data-theme="dark"] .btn-secondary-err:hover {
        background: rgba(255,255,255,0.1); border-color: #fff; color: #fff;
    }

    /* --- RODAPÉ DO CARD --- */
    .tech-info {
        margin-top: 40px; padding-top: 20px;
        border-top: 1px solid rgba(150,150,150,0.1);
        font-size: 0.85rem; color: var(--err-text); opacity: 0.5;
        font-family: monospace;
    }

    @media (max-width: 576px) {
        .error-card { padding: 40px 20px; }
        .bg-code { font-size: 8rem; }
        .btn-action { width: 100%; justify-content: center; margin: 5px 0; }
    }
</style>

<div class="error-page-wrapper">
    <div class="error-card">
        <div class="bg-code">500</div>

        <div class="icon-box">
            <i class="bi bi-hdd-network"></i>
        </div>

        <h1 class="error-title">Instabilidade Temporária</h1>
        
        <p class="error-msg">
            Nossos servidores encontraram uma dificuldade inesperada. 
            <br class="d-none d-md-block">
            Não se preocupe: <strong>nossa equipe técnica já foi notificada automaticamente</strong> e está a trabalhar na solução.
        </p>

        <div class="d-flex flex-wrap justify-content-center">
            <a href="{{ url_for('main.home') }}" class="btn-action btn-primary-err">
                <i class="bi bi-arrow-clockwise"></i> Recarregar / Início
            </a>
            <a href="mailto:{{ configs.get('contato_email', 'suporte@belarminomonteiro.com.br') }}" class="btn-action btn-secondary-err">
                <i class="bi bi-life-preserver"></i> Suporte
            </a>
        </div>

        <div class="tech-info">
            Código do Erro: 500 Internal Server Error <br>
            ID do Incidente: <span id="incident-id">GERANDO...</span>
        </div>
    </div>
</div>

<script>
    // Gera um ID de incidente falso para dar credibilidade técnica
    document.addEventListener('DOMContentLoaded', function() {
        const id = 'REQ-' + Math.random().toString(36).substr(2, 9).toUpperCase();
        document.getElementById('incident-id').textContent = id;
    });
</script>

{% endblock %}